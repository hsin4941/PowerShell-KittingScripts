# Windows自動化スクリプト集 (Windows Automation Scripts)

このリポジトリは、Windows PCのセットアップやメンテナンス作業を自動化するためのPowerShellスクリプトを管理します。

## 概要
PCの初期設定や、定期的なWindows Updateを簡単かつ確実に実行することを目指しています。
各スクリプトは、必要なツールのインストールから設定変更、再起動までを自動で行います。

---

## 使い方
このツールキットは、 `setup.bat` を実行することで簡単に利用できます。

1.  このリポジトリ全体をダウンロードまたはクローンします。
    -   画面右上の緑色の **`< > Code`** ボタンをクリックし、**`Download ZIP`** を選択するのが最も簡単です。
    -   ダウンロードしたZIPファイルを解凍し、任意の場所（例: `C:\temp\Win-Auto-Scripts`）に配置します。

2.  `setup.bat` を **右クリックし、「管理者として実行」** します。

3.  メニューが表示されるので、実行したい処理の番号を入力してEnterキーを押してください。
    ```
    ================================================
     実行したい処理を選択してください
    ================================================

     1. AutoWindowsUpdate を実行する

     2. AutoSetup を実行する

     3. 何もせずに終了する

    ================================================
    ```

---

## 提供するスクリプト

### 1. 全自動Windows Update (`AutoWindowsUpdate.ps1`)
Windows Updateを「最新の状態」になるまで、更新のインストールと再起動を全自動で繰り返します。

#### 主な機能
-   **完全自動化**: 一度実行すれば、すべての更新が完了するまで完全に放置できます。
-   **必須モジュールの自動インストール**: `PSWindowsUpdate`モジュールがない場合、自動でインストールします。
-   **自動再起動と継続**: 再起動が必要な場合、自動で再起動し、タスクスケジューラを利用して処理を継続します。
-   **ログ記録**: すべての実行履歴を `AutoUpdateLog.txt` に保存します。

---

### 2. PC初期設定（キッティング）自動化 (`AutoSetup.ps1`)
新しいPCのセットアップ作業を自動化します。アプリケーションのインストールからシステム設定の変更までを2つのフェーズに分けて実行します。

#### フェーズ1: 基本セットアップ
-   **アプリケーションのインストール**: Wingetを利用し、以下の基本的なツールを導入します。
    -   Google Chrome, 7-Zip, Microsoft PowerToys, Visual Studio Code, Node.js(LTS), Git, Zoom
-   **プリインストールアプリの削除**: Cortana、フィードバック Hubなど、利用頻度の低い標準アプリを削除します。
-   **システム設定の最適化**:
    -   隠しファイルや拡張子を常に表示
    -   エクスプローラーの右クリックメニューを従来の形式に変更 (Win11)
    -   高速スタートアップを無効化

#### フェーズ2: 開発環境のセットアップ (再起動後に自動実行)
-   **Node.js開発ツールのインストール**: `npm`を使い、以下のパッケージをグローバルにインストールします。
    -   `typescript`, `ts-node`, `nodemon`, `eslint`, `prettier`, `pnpm`
-   **ログ記録**: すべての実行履歴を `KittingLog.txt` に保存します。

---

## 注意事項
-   スクリプトの実行には管理者権限が必要です。必ず `setup.bat` を「管理者として実行」してください。
-   一部の処理（モジュールやアプリのインストール）にはインターネット接続が必要です。
-   このスクリプトは現状有姿で提供され、いかなる保証もありません。ご自身の責任においてご利用ください。

## ライセンス
このプロジェクトは [MIT License](LICENSE) の下で公開されています。
